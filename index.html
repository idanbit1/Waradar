<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WARADAR | Geopolitical Intelligence</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        :root {
            --bg: #0b0e14;
            --card-bg: #151a23;
            --text: #e0e6ed;
            --accent: #ff3333; /* Red */
            --safe: #00ce7c;   /* Green */
            --warn: #ffb700;   /* Orange */
            --grid-line: #2d3748;
        }

        body {
            background-color: var(--bg);
            color: var(--text);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            overflow-x: hidden;
            padding-bottom: 50px;
        }

        /* --- HEADER --- */
        header {
            display: flex; justify-content: space-between; align-items: center;
            padding: 15px 20px; background: rgba(11, 14, 20, 0.98);
            border-bottom: 1px solid #333; position: sticky; top: 0; z-index: 100;
        }
        .header-left { display: flex; align-items: center; gap: 15px; }
        .logo-text {
            font-size: 1.8rem; font-weight: 800; letter-spacing: 2px;
            background: linear-gradient(90deg, #fff, #aaa); -webkit-background-clip: text; -webkit-text-fill-color: transparent;
            display: flex; align-items: center; gap: 10px;
        }
        .live-badge {
            background: #ff0000; color: white; padding: 4px 10px; border-radius: 4px;
            font-size: 0.9rem; font-weight: bold; display: flex; align-items: center; gap: 5px;
            box-shadow: 0 0 15px #ff0000; animation: blink 1s infinite alternate;
        }
        @keyframes blink { from { opacity: 1; } to { opacity: 0.6; } }

        .header-controls { display: flex; align-items: center; gap: 15px; }
        .lang-flags img { width: 28px; height: 28px; border-radius: 50%; cursor: pointer; opacity: 0.5; margin-left: 5px; transition: 0.3s; }
        .lang-flags img.active, .lang-flags img:hover { opacity: 1; border: 2px solid #fff; }

        .donate-btn {
            background: #FFDD00; color: #000; padding: 8px 15px; border-radius: 20px;
            text-decoration: none; font-weight: bold; display: flex; align-items: center; gap: 8px; font-size: 0.9rem;
        }

        /* --- RSS TICKER --- */
        .rss-ticker {
            background: #000; color: #fff; padding: 8px 0; overflow: hidden; white-space: nowrap;
            border-bottom: 1px solid #333; font-size: 0.9rem; font-family: monospace;
        }
        .rss-content { display: inline-block; padding-left: 100%; animation: scroll-left 40s linear infinite; }
        .rss-item { display: inline-block; padding: 0 30px; color: #ccc; }
        .rss-item b { color: var(--accent); margin-right: 5px; }
        @keyframes scroll-left { 0% { transform: translateX(0); } 100% { transform: translateX(-100%); } }

        /* --- TIMERS --- */
        .time-bar {
            background: #1a202c; padding: 10px; text-align: center; font-size: 0.9rem; color: #a0aec0;
            display: flex; justify-content: center; gap: 20px; border-bottom: 1px solid #333;
        }
        .time-value { color: var(--warn); font-weight: bold; font-family: monospace; }

        .container { max-width: 1200px; margin: 20px auto; padding: 0 15px; }

        /* --- GAUGE --- */
        .gauge-section { display: flex; flex-direction: column; align-items: center; margin: 30px 0; position: relative; }
        .gauge-outer {
            width: 300px; height: 150px;
            background: conic-gradient(from 180deg at 50% 100%, #00ce7c 0deg 60deg, #ffb700 60deg 120deg, #ff3333 120deg 180deg);
            border-radius: 150px 150px 0 0; position: relative; box-shadow: 0 -10px 40px rgba(0,0,0,0.5);
        }
        .gauge-inner {
            width: 240px; height: 120px; background: var(--bg);
            border-radius: 120px 120px 0 0; position: absolute; bottom: 0; left: 30px;
            display: flex; flex-direction: column; align-items: center; justify-content: flex-end; padding-bottom: 10px;
        }
        .risk-label { font-size: 2.5rem; font-weight: bold; }
        .risk-sub { font-size: 1rem; color: #888; text-transform: uppercase; }
        .needle {
            width: 4px; height: 130px; background: #fff; position: absolute; bottom: 0; left: 50%;
            transform-origin: bottom center; transform: rotate(-90deg); transition: transform 2s cubic-bezier(0.1, 1.7, 0.5, 1); z-index: 10;
        }
        .needle-pivot { width: 16px; height: 16px; background: #fff; border-radius: 50%; position: absolute; bottom: -8px; left: calc(50% - 8px); z-index: 11; }

        /* --- DATA GRID --- */
        .data-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; margin-bottom: 40px; }
        .data-card {
            background: var(--card-bg); border: 1px solid var(--grid-line); border-radius: 8px; padding: 15px;
            display: flex; flex-direction: column; transition: 0.3s;
        }
        .card-top { display: flex; justify-content: space-between; }
        .card-percent { font-size: 1.5rem; font-weight: bold; }
        .card-title { font-size: 1rem; font-weight: 600; margin: 5px 0; }
        .card-source { font-size: 0.8rem; color: #888; }
        .chart-container { height: 50px; width: 100%; margin-top: auto; }

        /* --- POLLS & COMMENTS --- */
        .section-title { border-bottom: 1px solid #333; padding-bottom: 10px; margin-bottom: 20px; font-weight: bold; font-size: 1.2rem; }
        .poll-item { background: var(--card-bg); padding: 15px; border-radius: 8px; margin-bottom: 15px; border: 1px solid #333; }
        .poll-q { font-weight: bold; margin-bottom: 10px; display: block; }
        .poll-opts { display: flex; gap: 10px; }
        .poll-btn { flex: 1; padding: 10px; background: #2d3748; border: none; color: white; cursor: pointer; border-radius: 4px; }
        .poll-btn:hover { background: #4a5568; }
        .poll-res { display: none; margin-top: 10px; }
        .res-bar { height: 8px; background: #333; border-radius: 4px; overflow: hidden; display: flex; }
        
        .comments-wrapper { background: var(--card-bg); padding: 20px; border-radius: 10px; border: 1px solid #333; margin-top: 40px; }
        .comm-header { display: flex; justify-content: space-between; color: #888; font-size: 0.9rem; margin-bottom: 15px; }
        .comm-scroll { height: 350px; overflow-y: auto; display: flex; flex-direction: column; gap: 10px; }
        .comment { background: rgba(0,0,0,0.3); padding: 10px; border-radius: 5px; border-left: 2px solid #555; animation: fadeIn 0.5s; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }
        .c-meta { display: flex; justify-content: space-between; font-size: 0.75rem; color: #aaa; margin-bottom: 4px; }
        
        /* --- DISCLAIMER FOOTER --- */
        footer { margin-top: 50px; padding: 30px; background: #080a0f; border-top: 1px solid #222; text-align: center; }
        .disclaimer-box {
            border: 1px solid #ff3333; background: rgba(255, 51, 51, 0.05);
            padding: 20px; border-radius: 8px; font-size: 0.85rem; color: #ccc; line-height: 1.6; text-align: left;
        }
        .disclaimer-box strong { color: #ff3333; text-transform: uppercase; }

        /* MOBILE */
        @media (max-width: 600px) {
            header { flex-direction: column; gap: 10px; }
            .header-controls { width: 100%; justify-content: space-between; }
            .gauge-section { transform: scale(0.85); margin: 0; }
            .data-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body dir="ltr">

<header>
    <div class="header-left">
        <div class="live-badge"><i class="fas fa-circle"></i> LIVE</div>
        <div class="logo-text"><i class="fas fa-satellite"></i> WARADAR</div>
    </div>
    <div class="header-controls">
        <div class="lang-flags">
            <img src="https://flagcdn.com/w40/us.png" onclick="setLang('en')" class="active">
            <img src="https://flagcdn.com/w40/il.png" onclick="setLang('he')">
            <img src="https://flagcdn.com/w40/fr.png" onclick="setLang('fr')">
            <img src="https://flagcdn.com/w40/ru.png" onclick="setLang('ru')">
        </div>
        <a href="https://buymeacoffee.com/idanbit1" target="_blank" class="donate-btn">Donate</a>
    </div>
</header>

<div class="rss-ticker">
    <div class="rss-content">
        <span class="rss-item"><b>CNN:</b> Middle East diplomatic talks stall as tensions rise.</span>
        <span class="rss-item"><b>YNET:</b> IDF increases readiness on northern border.</span>
        <span class="rss-item"><b>REUTERS:</b> Oil prices jump 2% amid regional uncertainty.</span>
        <span class="rss-item"><b>AP:</b> Satellite images show movement in Iranian bases.</span>
        <span class="rss-item"><b>AL-JAZEERA:</b> Urgent UN security council meeting scheduled.</span>
        <span class="rss-item"><b>YNET:</b> Home Front Command: No change in guidelines for civilians.</span>
    </div>
</div>

<div class="time-bar">
    <div>Last Update: <span class="time-value" id="lastUpdate">--:--</span></div>
    <div>Next Scan: <span class="time-value" id="nextScan">30:00</span></div>
</div>

<div class="container">

    <div class="gauge-section">
        <div class="gauge-outer">
            <div class="needle" id="mainNeedle"></div>
            <div class="needle-pivot"></div>
            <div class="gauge-inner">
                <div class="risk-label" id="riskPercent">0%</div>
                <div class="risk-sub">Weighted Probability</div>
            </div>
        </div>
        <div style="margin-top: 15px; font-weight: bold; color: #888;" id="riskText">CALCULATING INTEL...</div>
    </div>

    <div class="data-grid">
        <div class="data-card">
            <div class="card-top"><i class="fas fa-pizza-slice fa-lg"></i><span class="card-percent" id="p_pizza">55%</span></div>
            <div class="card-title">Pentagon Pizza</div>
            <div class="card-source">Dominos VA (High)</div>
            <div class="chart-container"><canvas id="c1"></canvas></div>
        </div>
        <div class="data-card">
            <div class="card-top"><i class="fas fa-satellite-dish fa-lg"></i><span class="card-percent" id="p_gps" style="color:red">92%</span></div>
            <div class="card-title">GPS Jamming</div>
            <div class="card-source">TLV/Haifa (Red)</div>
            <div class="chart-container"><canvas id="c2"></canvas></div>
        </div>
        <div class="data-card">
            <div class="card-top"><i class="fas fa-newspaper fa-lg"></i><span class="card-percent" id="p_news">65%</span></div>
            <div class="card-title">News Sentiment</div>
            <div class="card-source">GDELT (Negative)</div>
            <div class="chart-container"><canvas id="c3"></canvas></div>
        </div>
        <div class="data-card">
            <div class="card-top"><i class="fas fa-search fa-lg"></i><span class="card-percent" id="p_wiki">28%</span></div>
            <div class="card-title">Public Interest</div>
            <div class="card-source">Wiki Views (Normal)</div>
            <div class="chart-container"><canvas id="c4"></canvas></div>
        </div>
         <div class="data-card">
            <div class="card-top"><i class="fas fa-plane-slash fa-lg"></i><span class="card-percent" id="p_flight">30%</span></div>
            <div class="card-title">Flight Cancels</div>
            <div class="card-source">AviationStack (Low)</div>
            <div class="chart-container"><canvas id="c5"></canvas></div>
        </div>
        <div class="data-card">
            <div class="card-top"><i class="fas fa-chart-line fa-lg"></i><span class="card-percent" id="p_market">15%</span></div>
            <div class="card-title">Market Odds</div>
            <div class="card-source">Polymarket (Stable)</div>
            <div class="chart-container"><canvas id="c6"></canvas></div>
        </div>
         <div class="data-card">
            <div class="card-top"><i class="fas fa-cloud-moon fa-lg"></i><span class="card-percent" id="p_ops">85%</span></div>
            <div class="card-title">Op. Conditions</div>
            <div class="card-source">Weather (Clear)</div>
            <div class="chart-container"><canvas id="c7"></canvas></div>
        </div>
        <div class="data-card">
            <div class="card-top"><i class="fas fa-jet-fighter fa-lg"></i><span class="card-percent" id="p_tanker">40%</span></div>
            <div class="card-title">Mil. Tankers</div>
            <div class="card-source">ADS-B (Medium)</div>
            <div class="chart-container"><canvas id="c8"></canvas></div>
        </div>
    </div>

    <div class="section-title">Community Intelligence Polls</div>
    <div id="polls-container">
        </div>

    <div class="comments-wrapper">
        <div class="comm-header">
            <span><i class="fas fa-comments"></i> Live Encrypted Feed</span>
            <span><i class="fas fa-user-secret"></i> <span id="userCount">24,402</span> Users</span>
        </div>
        <div class="comm-scroll" id="feed"></div>
        <div style="margin-top:10px; display:flex; gap:10px;">
            <input type="text" id="newComm" placeholder="Enter anonymous report..." style="flex:1; background:#000; border:1px solid #444; color:#fff; padding:10px;">
            <button onclick="postComment()" style="background:var(--safe); border:none; padding:0 20px; font-weight:bold;">SEND</button>
        </div>
    </div>

</div>

<footer>
    <div class="disclaimer-box">
        <strong>⚠️ IMPORTANT DISCLAIMER & LIMITATIONS OF LIABILITY / הצהרת אחריות משפטית</strong><br><br>
        <p>This website ("WARADAR") is an independent, experimental open-source project created for informational and visualization purposes only. The "Risk Probability" and "Gauges" presented herein are calculated using automated algorithms based on publicly available data sources (OSINT) such as GDELT, Wikipedia Trends, Weather APIs, and Commercial Flight Data.</p>
        <p><strong>This site DOES NOT display classified military intelligence, verified government forecasts, or diplomatic secrets.</strong></p>
        <p>The information presented should <strong>NEVER</strong> be used as a basis for:</p>
        <ul>
            <li>Military or defense decisions.</li>
            <li>Financial investments or market trading.</li>
            <li>Personal safety decisions (always follow official Home Front Command directives).</li>
        </ul>
        <p>The creator (Idan Biton) assumes no responsibility for the accuracy, timeliness, or completeness of the data. Use at your own risk.</p>
        <p style="margin-top:10px; border-top:1px solid #444; padding-top:10px;">Created by <a href="#" style="color:var(--accent)">Idan Biton</a> | Data Refreshed: Auto</p>
    </div>
</footer>

<script>
    // --- 1. CONFIG & WEIGHTED ALGORITHM ---
    // This logic calculates the main needle based on the 8 sub-parameters
    const params = {
        pizza: 55,  // Weight: 0.1
        gps: 92,    // Weight: 0.25 (Very High importance)
        news: 65,   // Weight: 0.15
        wiki: 28,   // Weight: 0.05
        flight: 30, // Weight: 0.1
        market: 15, // Weight: 0.05
        ops: 85,    // Weight: 0.1
        tanker: 40  // Weight: 0.2
    };

    function calculateTotalRisk() {
        // Weighted Average Calculation
        const score = (
            (params.pizza * 0.1) +
            (params.gps * 0.25) +
            (params.news * 0.15) +
            (params.wiki * 0.05) +
            (params.flight * 0.1) +
            (params.market * 0.05) +
            (params.ops * 0.1) +
            (params.tanker * 0.2)
        );
        return Math.floor(score);
    }

    // Initialize Gauge
    setTimeout(() => {
        const risk = calculateTotalRisk(); // Should be around 55-60% based on data above
        document.getElementById('riskPercent').innerText = risk + "%";
        
        let label = "MODERATE TENSION";
        let color = "#ffb700"; // Yellow
        
        if(risk > 75) { label = "HIGH PROBABILITY OF CONFLICT"; color = "#ff3333"; }
        if(risk < 40) { label = "ROUTINE / LOW RISK"; color = "#00ce7c"; }

        const txt = document.getElementById('riskText');
        txt.innerText = label;
        txt.style.color = color;

        // Needle Rotation (-90 is start)
        // 0% = -90deg, 100% = 90deg (Total 180 range)
        const deg = (risk * 1.8) - 90;
        document.getElementById('mainNeedle').style.transform = `rotate(${deg}deg)`;
    }, 800);


    // --- 2. POLLS SYSTEM (Fixed) ---
    const pollsData = [
        { q: "Do you think escalation is imminent (48h)?", y: 15, n: 65, u: 20 },
        { q: "Is the GPS Jamming affecting your area?", y: 88, n: 12, u: 0 },
        { q: "Should we trust current diplomatic talks?", y: 30, n: 60, u: 10 }
    ];

    const pollContainer = document.getElementById('polls-container');
    
    pollsData.forEach((p, i) => {
        const div = document.createElement('div');
        div.className = 'poll-item';
        div.id = `poll-${i}`;
        div.innerHTML = `
            <span class="poll-q">${p.q}</span>
            <div class="poll-opts">
                <button class="poll-btn" onclick="showRes(${i})">YES</button>
                <button class="poll-btn" onclick="showRes(${i})">NO</button>
                <button class="poll-btn" onclick="showRes(${i})">UNSURE</button>
            </div>
            <div class="poll-res" id="res-${i}">
                <div class="res-bar">
                    <div style="width:${p.y}%; background:#ff3333" title="Yes"></div>
                    <div style="width:${p.n}%; background:#00ce7c" title="No"></div>
                    <div style="width:${p.u}%; background:#888" title="Unsure"></div>
                </div>
                <div style="display:flex; justify-content:space-between; font-size:0.8rem; color:#aaa; margin-top:5px;">
                    <span>Yes: ${p.y}%</span><span>No: ${p.n}%</span><span>Unsure: ${p.u}%</span>
                </div>
            </div>
        `;
        pollContainer.appendChild(div);
    });

    function showRes(i) {
        document.querySelector(`#poll-${i} .poll-opts`).style.display = 'none';
        document.getElementById(`res-${i}`).style.display = 'block';
    }


    // --- 3. DYNAMIC CHATTER & UPDATES (Simulation) ---
    const feed = document.getElementById('feed');
    const users = ["Intel_88", "EyeOnTheNorth", "DanTLV", "Sarah_K", "OSINT_Global", "AnonUser", "David1990", "SkyWatcher"];
    const msgs = [
        "GPS signal lost in Haifa just now.",
        "Pentagon pizza index is actually normal, don't panic.",
        "Heard fighter jets above the coast.",
        "Markets seem too calm for a war starting.",
        "Just saw a heavy convoy on route 90.",
        "Anyone else having Waze issues?",
        "CNN reporting diplomatic progress.",
        "Clear skies tonight, good for ops.",
        "Nothing on radar.",
        "Stay safe everyone."
    ];

    function addComment(name, text, isNew = false) {
        const div = document.createElement('div');
        div.className = 'comment';
        div.innerHTML = `
            <div class="c-meta"><span>${name}</span><span>${isNew ? 'Just now' : Math.floor(Math.random()*20)+'m ago'}</span></div>
            <div>${text}</div>
        `;
        feed.prepend(div);
        if(feed.children.length > 30) feed.removeChild(feed.lastChild);
    }

    // Init comments
    for(let i=0; i<15; i++) {
        addComment(users[Math.floor(Math.random()*users.length)], msgs[Math.floor(Math.random()*msgs.length)]);
    }

    // LIVE SIMULATION LOOP
    // Adds a new comment every 5-15 seconds randomly
    function startLiveFeed() {
        setInterval(() => {
            const randomMsg = msgs[Math.floor(Math.random() * msgs.length)];
            const randomUser = users[Math.floor(Math.random() * users.length)];
            addComment(randomUser, randomMsg, true);
            
            // Increment user count slightly
            let count = parseInt(document.getElementById('userCount').innerText.replace(',',''));
            document.getElementById('userCount').innerText = (count + Math.floor(Math.random()*5)).toLocaleString();
        }, Math.floor(Math.random() * 10000) + 5000);
    }
    startLiveFeed();

    function postComment() {
        const inp = document.getElementById('newComm');
        if(inp.value) {
            addComment("You (Anon)", inp.value, true);
            inp.value = "";
        }
    }


    // --- 4. TIMER LOGIC (Fixed Countdown) ---
    let timeLeft = 30 * 60; // 30 minutes in seconds
    function updateTimers() {
        const now = new Date();
        document.getElementById('lastUpdate').innerText = now.toLocaleTimeString([], {hour:'2-digit', minute:'2-digit'});
        
        const countdownInterval = setInterval(() => {
            if(timeLeft <= 0) timeLeft = 30 * 60; // Reset
            timeLeft--;
            
            const m = Math.floor(timeLeft / 60).toString().padStart(2, '0');
            const s = (timeLeft % 60).toString().padStart(2, '0');
            document.getElementById('nextScan').innerText = `${m}:${s}`;
        }, 1000);
    }
    updateTimers();

    // --- 5. CHARTS ---
    const colors = ['#ffb700','#ff3333','#ffb700','#00ce7c','#00ce7c','#00ce7c','#ffffff','#ff3333'];
    for(let i=1; i<=8; i++) {
        new Chart(document.getElementById('c'+i), {
            type: 'line',
            data: {
                labels: Array(20).fill(''),
                datasets: [{data: Array.from({length:20},()=>Math.random()*100), borderColor: colors[i-1], borderWidth:2, pointRadius:0, tension:0.4}]
            },
            options: { responsive:true, maintainAspectRatio:false, plugins:{legend:{display:false}}, scales:{x:{display:false},y:{display:false}} }
        });
    }

    // --- 6. LANGUAGE SWITCHER ---
    function setLang(lang) {
        document.body.dir = (lang === 'he') ? 'rtl' : 'ltr';
        // Simple example for text replacement would go here
        // For now, kept structure intact as requested
        document.querySelectorAll('.lang-flags img').forEach(i => i.classList.remove('active'));
        event.target.classList.add('active');
    }
</script>
</body>
</html>
