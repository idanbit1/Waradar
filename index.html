<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WARADAR | Advanced OSINT Monitor</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        :root {
            --bg: #050505;
            --panel: #0f1115;
            --border: #1f2228;
            --text-main: #e0e6ed;
            --text-muted: #6b7280;
            --accent: #ff3333; /* High Risk */
            --safe: #00ce7c;   /* Low Risk */
            --warn: #eab308;   /* Medium Risk */
            --blue: #3b82f6;   /* Info */
        }

        * { box-sizing: border-box; }

        body {
            background-color: var(--bg);
            color: var(--text-main);
            font-family: 'Segoe UI', 'Roboto', monospace;
            margin: 0; padding: 0;
            overflow-x: hidden;
            font-size: 14px;
        }

        /* --- HEADER --- */
        header {
            background: rgba(5, 5, 5, 0.95);
            border-bottom: 1px solid var(--border);
            padding: 15px 20px;
            display: flex; justify-content: space-between; align-items: center;
            position: sticky; top: 0; z-index: 100;
            backdrop-filter: blur(10px);
        }
        .brand { font-size: 1.5rem; font-weight: 800; letter-spacing: 2px; color: #fff; display: flex; align-items: center; gap: 10px; }
        .live-dot { height: 8px; width: 8px; background: red; border-radius: 50%; box-shadow: 0 0 10px red; animation: blink 1s infinite; }
        @keyframes blink { 50% { opacity: 0.5; } }
        
        .header-meta { display: flex; gap: 20px; font-family: monospace; color: var(--text-muted); font-size: 0.85rem; }
        .meta-item b { color: var(--text-main); }

        /* --- LAYOUT --- */
        .container {
            max-width: 1400px; margin: 0 auto; padding: 20px;
            display: grid; grid-template-columns: 3fr 1fr; gap: 20px;
        }

        /* --- MAIN GAUGE AREA --- */
        .risk-overview {
            grid-column: 1 / -1;
            background: var(--panel); border: 1px solid var(--border); border-radius: 6px;
            padding: 20px; display: flex; align-items: center; justify-content: space-between;
        }
        .gauge-container { width: 100%; max-width: 400px; height: 20px; background: #222; border-radius: 10px; position: relative; overflow: hidden; }
        .gauge-fill { height: 100%; background: linear-gradient(90deg, var(--safe), var(--warn), var(--accent)); width: 0%; transition: width 1s; }
        .risk-text { font-size: 2rem; font-weight: bold; margin-bottom: 5px; }
        .risk-desc { color: var(--text-muted); font-size: 0.9rem; text-transform: uppercase; letter-spacing: 1px; }

        /* --- METRIC CARDS --- */
        .metrics-grid {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 15px;
        }
        .card {
            background: var(--panel); border: 1px solid var(--border); border-radius: 6px;
            padding: 15px; display: flex; flex-direction: column; transition: 0.2s;
        }
        .card:hover { border-color: #333; transform: translateY(-2px); }
        
        .card-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 10px; }
        .card-title { font-weight: 600; font-size: 1rem; color: #fff; display: flex; align-items: center; gap: 8px; }
        .card-source { font-size: 0.75rem; color: var(--text-muted); cursor: pointer; text-decoration: underline; }
        
        .card-stats { display: flex; align-items: baseline; gap: 10px; margin-bottom: 10px; }
        .stat-value { font-size: 1.8rem; font-weight: 700; font-family: monospace; }
        .stat-change { font-size: 0.9rem; font-weight: 600; padding: 2px 6px; border-radius: 4px; }
        .change-up { color: var(--accent); background: rgba(255, 51, 51, 0.1); }
        .change-down { color: var(--safe); background: rgba(0, 206, 124, 0.1); }
        
        .chart-wrapper { height: 80px; width: 100%; margin-top: auto; }

        /* --- SIDEBAR (Sources & News) --- */
        .sidebar { display: flex; flex-direction: column; gap: 20px; }
        .side-panel { background: var(--panel); border: 1px solid var(--border); border-radius: 6px; padding: 15px; }
        .side-title { font-weight: bold; border-bottom: 1px solid var(--border); padding-bottom: 10px; margin-bottom: 10px; font-size: 0.9rem; text-transform: uppercase; color: var(--text-muted); }
        
        .source-link { display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid #1a1a1a; font-size: 0.9rem; text-decoration: none; color: var(--text-main); transition: 0.2s; }
        .source-link:hover { padding-left: 5px; color: var(--blue); }
        .source-link span:last-child { color: var(--text-muted); font-size: 0.8rem; }

        .news-item { margin-bottom: 12px; font-size: 0.85rem; line-height: 1.4; border-left: 2px solid var(--blue); padding-left: 10px; }
        .news-time { color: var(--text-muted); font-size: 0.75rem; display: block; margin-bottom: 2px; }

        /* --- FOOTER --- */
        footer { border-top: 1px solid var(--border); padding: 30px; text-align: center; color: var(--text-muted); margin-top: 40px; font-size: 0.8rem; }

        /* RESPONSIVE */
        @media (max-width: 900px) {
            .container { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>

<header>
    <div class="brand">
        <div class="live-dot"></div>
        WARADAR <span style="font-weight:400; font-size:0.9rem; opacity:0.7;">PRO</span>
    </div>
    <div class="header-meta">
        <div class="meta-item">DEFCON: <b>3</b></div>
        <div class="meta-item">UPDATE: <b id="lastUpdate">--:--</b></div>
        <div class="meta-item">SCAN: <b id="nextScan" style="color:var(--blue)">00:30</b></div>
    </div>
</header>

<div class="container">

    <div class="risk-overview">
        <div>
            <div class="risk-text" id="riskLabel">MODERATE</div>
            <div class="risk-desc">Weighted Probability Index</div>
        </div>
        <div style="flex: 1; margin: 0 40px;">
            <div style="display:flex; justify-content:space-between; margin-bottom:5px; font-size:0.8rem; color:#888;">
                <span>Routine</span>
                <span>Elevated</span>
                <span>Critical</span>
            </div>
            <div class="gauge-container">
                <div class="gauge-fill" id="riskFill"></div>
            </div>
            <div style="text-align:right; margin-top:5px; font-family:monospace; font-size:1.2rem; font-weight:bold;" id="riskPercent">0%</div>
        </div>
    </div>

    <div class="metrics-grid">
        
        <div class="card">
            <div class="card-header">
                <div class="card-title"><i class="fas fa-jet-fighter"></i> Stratotankers</div>
                <a href="https://globe.adsbexchange.com/" target="_blank" class="card-source">ADS-B Exch</a>
            </div>
            <div class="card-stats">
                <div class="stat-value" id="val_tanker">62</div>
                <div class="stat-change change-up" id="chg_tanker">+4.2%</div>
            </div>
            <div class="chart-wrapper"><canvas id="chart_tanker"></canvas></div>
        </div>

        <div class="card">
            <div class="card-header">
                <div class="card-title"><i class="fas fa-satellite-dish"></i> GPS Interference</div>
                <a href="https://gpsjam.org/" target="_blank" class="card-source">GPSJam.org</a>
            </div>
            <div class="card-stats">
                <div class="stat-value" id="val_gps" style="color:var(--accent)">98%</div>
                <div class="stat-change change-up" id="chg_gps">+1.1%</div>
            </div>
            <div class="chart-wrapper"><canvas id="chart_gps"></canvas></div>
        </div>

        <div class="card">
            <div class="card-header">
                <div class="card-title"><i class="fas fa-pizza-slice"></i> Pentagon Pizza</div>
                <a href="#" class="card-source">Google Maps</a>
            </div>
            <div class="card-stats">
                <div class="stat-value" id="val_pizza">High</div>
                <div class="stat-change change-down" id="chg_pizza">-2.5%</div>
            </div>
            <div class="chart-wrapper"><canvas id="chart_pizza"></canvas></div>
        </div>

        <div class="card">
            <div class="card-header">
                <div class="card-title"><i class="fas fa-chart-line"></i> Conflict Odds</div>
                <a href="https://polymarket.com/" target="_blank" class="card-source">Polymarket</a>
            </div>
            <div class="card-stats">
                <div class="stat-value" id="val_market">18%</div>
                <div class="stat-change change-down" id="chg_market">0.0%</div>
            </div>
            <div class="chart-wrapper"><canvas id="chart_market"></canvas></div>
        </div>

        <div class="card">
            <div class="card-header">
                <div class="card-title"><i class="fas fa-newspaper"></i> News Sentiment</div>
                <a href="https://www.gdeltproject.org/" target="_blank" class="card-source">GDELT</a>
            </div>
            <div class="card-stats">
                <div class="stat-value" id="val_news">Neg</div>
                <div class="stat-change change-up" id="chg_news">+8.4%</div>
            </div>
            <div class="chart-wrapper"><canvas id="chart_news"></canvas></div>
        </div>

        <div class="card">
            <div class="card-header">
                <div class="card-title"><i class="fas fa-cloud"></i> Visibility (Ops)</div>
                <a href="https://open-meteo.com/" target="_blank" class="card-source">OpenMeteo</a>
            </div>
            <div class="card-stats">
                <div class="stat-value" id="val_weather">10km</div>
                <div class="stat-change change-down" style="color:#aaa">Stable</div>
            </div>
            <div class="chart-wrapper"><canvas id="chart_weather"></canvas></div>
        </div>

    </div>

    <div class="sidebar">
        
        <div class="side-panel">
            <div class="side-title">Critical Intel Sources</div>
            <a href="https://www.iaea.org/" target="_blank" class="source-link">
                IAEA (Nuclear Watch) <span>Official</span>
            </a>
            <a href="https://www.centcom.mil/" target="_blank" class="source-link">
                US CENTCOM <span>Military</span>
            </a>
            <a href="https://www.understandingwar.org/" target="_blank" class="source-link">
                Inst. Study of War <span>Research</span>
            </a>
            <a href="https://liveuamap.com/" target="_blank" class="source-link">
                LiveUAMap <span>Map</span>
            </a>
            <a href="https://www.oref.org.il/" target="_blank" class="source-link">
                Home Front Cmd <span>Civil</span>
            </a>
        </div>

        <div class="side-panel">
            <div class="side-title">Live Updates</div>
            <div id="news-feed">
                </div>
        </div>

    </div>

</div>

<footer>
    <p>WARADAR PRO | Advanced Geopolitical Analysis Dashboard</p>
    <p style="opacity:0.5; margin-top:10px;">Created by Idan Biton. Data sources: OSINT, GDELT, ADS-B, Weather APIs. Not for operational use.</p>
</footer>

<script>
    // --- 1. CHART.JS CONFIGURATION (THE INTERACTIVE PART) ---
    // This creates the "Pizzint" style interactive graphs
    
    Chart.defaults.color = '#6b7280';
    Chart.defaults.borderColor = 'rgba(255,255,255,0.05)';

    const commonOptions = {
        responsive: true,
        maintainAspectRatio: false,
        interaction: {
            mode: 'index',
            intersect: false,
        },
        plugins: {
            legend: { display: false },
            tooltip: {
                enabled: true,
                backgroundColor: 'rgba(0,0,0,0.9)',
                titleColor: '#fff',
                bodyColor: '#fff',
                borderColor: '#333',
                borderWidth: 1,
                displayColors: false,
                callbacks: {
                    title: function(context) {
                        return 'Time: -' + (24 - context[0].dataIndex) + 'H';
                    },
                    label: function(context) {
                        return 'Value: ' + context.raw;
                    }
                }
            }
        },
        scales: {
            x: { display: false }, // Hide X axis for clean look
            y: { display: false }  // Hide Y axis
        },
        elements: {
            point: { radius: 0, hoverRadius: 4 }, // Only show dots on hover
            line: { tension: 0.1, borderWidth: 2 } // Sharp lines
        }
    };

    // Helper to generate fake history data (24 points)
    function generateHistory(base, volatility) {
        let data = [];
        let current = base;
        for(let i=0; i<24; i++) {
            let change = (Math.random() - 0.5) * volatility;
            current += change;
            if(current < 0) current = 0;
            if(current > 100) current = 100;
            data.push(Math.floor(current));
        }
        return data;
    }

    // --- 2. DATA INITIALIZATION ---
    
    const metrics = {
        tanker: { base: 60, vol: 15, color: '#ffb700', label: 'Activity' },
        gps: { base: 95, vol: 5, color: '#ff3333', label: 'Interference' },
        pizza: { base: 50, vol: 20, color: '#eab308', label: 'Volume' },
        market: { base: 18, vol: 5, color: '#3b82f6', label: 'Odds' },
        news: { base: 70, vol: 10, color: '#ef4444', label: 'Sentiment' },
        weather: { base: 85, vol: 5, color: '#00ce7c', label: 'Visibility' }
    };

    const charts = {};

    // Initialize all charts
    for (const [key, config] of Object.entries(metrics)) {
        const ctx = document.getElementById(`chart_${key}`).getContext('2d');
        const history = generateHistory(config.base, config.vol);
        
        // Calculate Change for display
        const current = history[history.length - 1];
        const prev = history[history.length - 2];
        const change = ((current - prev) / prev * 100).toFixed(1);
        
        // Update DOM Text
        const elVal = document.getElementById(`val_${key}`);
        const elChg = document.getElementById(`chg_${key}`);
        
        if(key === 'weather') elVal.innerText = current + '%'; // Special formatting
        else if(key === 'pizza') elVal.innerText = current > 70 ? 'High' : 'Normal';
        else if(key === 'news') elVal.innerText = current > 60 ? 'Neg' : 'Pos';
        else elVal.innerText = current;

        // Update Change Badge
        elChg.innerText = (change > 0 ? '+' : '') + change + '%';
        elChg.className = `stat-change ${change >= 0 ? 'change-up' : 'change-down'}`;
        if(key === 'gps' || key === 'tanker') {
             // For bad things, increase is red (change-up style)
             // Default logic works
        } else if (key === 'weather') {
             // For weather, increase is good? Logic depends. Keeping simple.
        }

        // Draw Chart
        charts[key] = new Chart(ctx, {
            type: 'line',
            data: {
                labels: Array.from({length: 24}, (_, i) => i),
                datasets: [{
                    label: config.label,
                    data: history,
                    borderColor: config.color,
                    backgroundColor: config.color.replace(')', ', 0.1)').replace('rgb', 'rgba'),
                    fill: true
                }]
            },
            options: commonOptions
        });
    }

    // --- 3. RISK CALCULATION ---
    function updateRisk() {
        // Weighted calculation based on current chart values
        const vals = {};
        for (const key of Object.keys(metrics)) {
            const data = charts[key].data.datasets[0].data;
            vals[key] = data[data.length - 1];
        }

        const score = (
            (vals.tanker * 0.25) + 
            (vals.gps * 0.25) + 
            (vals.news * 0.15) + 
            (vals.market * 0.15) + 
            (vals.pizza * 0.10) + 
            (vals.weather * 0.10)
        );
        
        const risk = Math.floor(score);
        
        // Update UI
        document.getElementById('riskPercent').innerText = risk + "%";
        document.getElementById('riskFill').style.width = risk + "%";
        
        const label = document.getElementById('riskLabel');
        if(risk < 40) { label.innerText = "LOW"; label.style.color = "var(--safe)"; }
        else if(risk < 75) { label.innerText = "ELEVATED"; label.style.color = "var(--warn)"; }
        else { label.innerText = "CRITICAL"; label.style.color = "var(--accent)"; }
    }
    updateRisk();

    // --- 4. NEWS SIMULATION ---
    const newsItems = [
        { time: "10:42", text: "US CENTCOM reports routine patrol activity in Persian Gulf." },
        { time: "10:15", text: "Satellite imagery shows minor movement at Iranian missile sites." },
        { time: "09:30", text: "Oil prices stabilize after morning volatility." },
        { time: "08:45", text: "Diplomatic channels remain active in Cairo." }
    ];

    const newsContainer = document.getElementById('news-feed');
    newsItems.forEach(item => {
        newsContainer.innerHTML += `
            <div class="news-item">
                <span class="news-time">${item.time}</span>
                ${item.text}
            </div>
        `;
    });

    // --- 5. TIME UPDATES ---
    setInterval(() => {
        const now = new Date();
        document.getElementById('lastUpdate').innerText = now.toLocaleTimeString([], {hour:'2-digit', minute:'2-digit'});
    }, 1000);

</script>
</body>
</html>
